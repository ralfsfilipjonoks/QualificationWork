{% extends 'header.html' %} {% block title %}Admin marker table{% endblock %} {%
block content %} {% if points %}
<script
  src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
  integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
  crossorigin="anonymous"></script>

<script
  src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
  integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
  crossorigin="anonymous"></script>
<style>
  .table-responsive {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    white-space: nowrap;
  }
  .table-hover th:hover {
    cursor: pointer;
    background-color: #f5f5f5;
  }
</style>
<div class="table-responsive">
  <table class="table table-striped table-hover" id="myTable">
    <thead>
      <tr>
        <th scope="col">id</th>
        <th scope="col">latitude</th>
        <th scope="col">longitude</th>
        <th scope="col">name</th>
        <th scope="col">description</th>
        <th scope="col">post date</th>
        <th scope="col">remove date</th>
        <th scope="col">type</th>
        <th scope="col">author</th>
        <th scope="col">Delete</th>
      </tr>
    </thead>
    <tbody>
      {% for x in points %}
      <tr>
        <td scope="row">{{ x['_id'] }}</td>
        <td>{{ x['latitude'] }}</td>
        <td>{{ x['longitude'] }}</td>
        <td>{{ x['name'] }}</td>
        <td>{{ x['description'] }}</td>
        <td>{{ x['postdate'] }}</td>
        <td>{{ x['removedate'] }}</td>
        <td>{{ x['type'] }}</td>
        <td>{{ x['author'] }}</td>
        <td>
          <form
            action="/admin_ui/markers/delete_point/{{ x['_id'] }}"
            method="POST">
            <button
              style="margin-right: 10px"
              type="submit"
              class="btn btn-danger">
              Delete
            </button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<div class="alert alert-danger" style="margin: 10px" role="alert">
  No markers.
</div>
{% endif %}
<script>
  // Get the table and its headers
  const table = document.getElementById("myTable");
  const headers = table.querySelectorAll("th");

  // Add click event listener to each header
  headers.forEach((header, index) => {
    header.addEventListener("click", () => {
      // Get the table rows
      const rows = table.querySelectorAll("tbody tr");
      // Create an array from the rows and sort it by the clicked header
      const sortedRows = Array.from(rows).sort((a, b) => {
        const aText = a
          .querySelector(`td:nth-child(${index + 1})`)
          .textContent.trim();
        const bText = b
          .querySelector(`td:nth-child(${index + 1})`)
          .textContent.trim();
        return aText.localeCompare(bText);
      });
      // Reverse the sorted array if the header is already sorted in ascending order
      if (header.classList.contains("asc")) {
        sortedRows.reverse();
        header.classList.remove("asc");
        header.classList.add("desc");
      } else {
        header.classList.remove("desc");
        header.classList.add("asc");
      }
      // Replace the old rows with the sorted rows
      rows.forEach((row) => row.remove());
      sortedRows.forEach((row) =>
        table.querySelector("tbody").appendChild(row)
      );
    });
  });
</script>
{% endblock %}
